"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6708],{1359:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var r=t(4848),s=t(8453);const i={title:"Go,Gin\u5b66\u4e60",date:new Date("2024-07-11T00:00:00.000Z"),pinned:9,author:"ayanami"},c=void 0,l={permalink:"/blog/Go-Gin\u5b66\u4e60",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Go-Gin\u5b66\u4e60.md",source:"@site/blog/Go-Gin\u5b66\u4e60.md",title:"Go,Gin\u5b66\u4e60",description:"Go & Gin & Gorm \u5b66\u4e60",date:"2024-07-11T00:00:00.000Z",tags:[],readingTime:19.71,hasTruncateMarker:!1,authors:[{name:"ayanami"}],frontMatter:{title:"Go,Gin\u5b66\u4e60",date:"2024-07-11T00:00:00.000Z",pinned:9,author:"ayanami"},unlisted:!1,prevItem:{title:"xv6book",permalink:"/blog/xv6book"},nextItem:{title:"hibernate&jpa",permalink:"/blog/hibernate-jpa"}},a={authorsImageUrls:[void 0]},d=[{value:"Go &amp; Gin &amp; Gorm \u5b66\u4e60",id:"go--gin--gorm-\u5b66\u4e60",level:3},{value:"Go",id:"go",level:4},{value:"\u57fa\u672c\u8bed\u6cd5",id:"\u57fa\u672c\u8bed\u6cd5",level:5},{value:"Gin",id:"gin",level:4},{value:"gorm",id:"gorm",level:3},{value:"\u5b9e\u6218\uff1ajcourse_go",id:"\u5b9e\u6218jcourse_go",level:3}];function o(n){const e={a:"a",code:"code",h3:"h3",h4:"h4",h5:"h5",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h3,{id:"go--gin--gorm-\u5b66\u4e60",children:"Go & Gin & Gorm \u5b66\u4e60"}),"\n",(0,r.jsx)(e.h4,{id:"go",children:"Go"}),"\n",(0,r.jsx)(e.p,{children:"Learn go by test"}),"\n",(0,r.jsx)(e.h5,{id:"\u57fa\u672c\u8bed\u6cd5",children:"\u57fa\u672c\u8bed\u6cd5"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"package"}),":\u7c7b\u4f3c",(0,r.jsx)(e.code,{children:"namespace"}),"\u6216\u8005",(0,r.jsx)(e.code,{children:"module"})]}),"\n",(0,r.jsx)(e.p,{children:"\u5faa\u73af"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:"func Repeat(character string) string {\n\tvar repeat string\n\tfor i:=1;i<=5;i++{\n\t\trepeat = repeat + character\n\t}\n\treturn repeat\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u5176\u4e2d",(0,r.jsx)(e.code,{children:":="}),"\u662f\u5e26\u521d\u59cb\u503c\u5b9a\u4e49\u7684\u8bed\u6cd5\u7cd6\uff0c",(0,r.jsx)(e.code,{children:"var name type"}),"\u662f\u4e0d\u5e26\u521d\u59cb\u503c\u7684\u5b9a\u4e49\uff1bgo \u7684\u5faa\u73af\u53ea\u6709 for"]}),"\n",(0,r.jsx)(e.p,{children:"\u6d4b\u8bd5\u793a\u4f8b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'import (\n\t"testing"\n)\nfunc TestRepeat(t *testing.T){\n\tgot:=Repeat("a")\n\texpect:="aaaaa"\n\tif got!=expect{\n\t\tt.Errorf("got %q, expect %q", got, expect)\n\t}\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u4f7f\u7528"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"go test\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u8fd0\u884c\u6d4b\u8bd5\uff0c\u5982\u679c\u6709\u5b9a\u4e49 main \u51fd\u6570\uff08\u5728",(0,r.jsx)(e.code,{children:"package main"}),"\u4e4b\u4e2d\uff09\uff0c\u5219\u53ef\u4ee5\u76f4\u63a5",(0,r.jsx)(e.code,{children:"go run xx.go"})]}),"\n",(0,r.jsx)(e.p,{children:"go \u5305\u5185\u51fd\u6570\u548c\u6210\u5458\u53d8\u91cf\u7684\u53ef\u89c1\u6027\u662f\u901a\u8fc7\u5927\u5c0f\u5199\u533a\u5206\u7684\uff0c\u5927\u5199\u5bf9\u5305\u5916\u53ef\u89c1\uff0c\u5c0f\u5199\u4e0d\u53ef\u89c1"}),"\n",(0,r.jsxs)(e.p,{children:["test \u51fd\u6570\u9700\u8981\u5199\u6210",(0,r.jsx)(e.code,{children:"TestXXX"}),"\u7684\u5f62\u5f0f\uff0c\u540c\u65f6\u6587\u4ef6\u540d\u4e5f\u8981\u5199\u6210",(0,r.jsx)(e.code,{children:"whatfiles_test"})]}),"\n",(0,r.jsxs)(e.p,{children:["\u57fa\u51c6\u6d4b\u8bd5 benchmark\uff0c",(0,r.jsx)(e.code,{children:"BenchmarkXXX"}),"\u51fd\u6570\u540d"]}),"\n",(0,r.jsx)(e.p,{children:"strings \u5e93\u548c\u76f8\u5173\u51fd\u6570"}),"\n",(0,r.jsx)(e.p,{children:"range \u8fed\u4ee3"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:"func Sum(arr []int) int {\n\tsum := 0\n\t// index, element\n\tfor _, ele := range arr{\n\t\tsum += ele\n\t}\n\treturn sum\n}\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"go test -cover # \u6d4b\u8bd5\u6d4b\u8bd5\u8986\u76d6\u7387\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u53d8\u957f\u53c2\u6570\u548c append"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:"func SumAll(arrs ...[]int) []int{\n\tans:=[]int{}\n\tfor _, arr := range arrs{\n\t\tans = append(ans, Sum(arr))\n\t}\n\treturn ans\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u6307\u9488(\u51fd\u6570\u53ef\u4ee5\u76f4\u63a5\u7ed9\u53d8\u91cf)"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'\tcheckSums := func(t testing.TB, got, want []int) {\n\t\tt.Helper()\n\t\tif !reflect.DeepEqual(got, want) {\n\t\t\tt.Errorf("got %v want %v", got, want)\n\t\t}\n\t}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u96c6\u5408\u5207\u7247\uff1ago \u652f\u6301\u7c7b\u4f3c python \u7684\u5207\u7247"}),"\n",(0,r.jsx)(e.p,{children:"\u7ed3\u6784\u548c\u65b9\u6cd5\uff08OOP\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'import "math"\ntype Rectangle struct {\n   width float32\n   height float32\n}\ntype Circle struct {\n\tradius float32\n\tcenter_x float32\n\tcenter_y float32\n}\nfunc (r Rectangle) Area() float32 {\n\treturn r.width * r.height\n}\nfunc (c Circle) Area() float32 {\n\treturn math.Pi * c.radius * c.radius\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"go \u4e0d\u5141\u8bb8\u51fd\u6570\u91cd\u8f7d\uff0c\u7c7b\u5b8c\u5168\u548c\u7ed3\u6784\u4f53\u7b49\u4ef7\uff0c\u7c7b\u5185\u51fd\u6570\uff08\u65b9\u6cd5\uff09\u5982\u4e0a\u5b9a\u4e49"}),"\n",(0,r.jsx)(e.p,{children:"\u7ed3\u6784\u4f53\u53ef\u4ee5\u5d4c\u5957\uff0c\u5e76\u4e14\u652f\u6301\u6298\u53e0\u8c03\u7528\uff08\u4f8b\u5982 A.B.ccc, ccc \u662f B \u7684\u5c5e\u6027\uff0cB \u662f A \u7684\u5c5e\u6027\uff0c\u53ef\u4ee5\u76f4\u63a5 A.ccc\uff09"}),"\n",(0,r.jsx)(e.p,{children:"go \u6709 interface"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:"type Shape interface{\n\tArea() float32\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u6d4b\u8bd5\u4e5f\u65b9\u4fbf"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'func TestArea(t *testing.T){\n\tcheckArea := func(t *testing.T, shape Shape, expect float32){\n\t\tdiff := shape.Area() - expect\n\t\tif math.Abs(float64(diff)) > 1e-6{\n\t\t\tt.Errorf("expect %v, got %v, diff %v", expect, shape.Area(), diff)\n\t\t}\n\t}\n\tt.Run("rectangles", func(t *testing.T) {\n\t\trectangle := Rectangle{12, 6}\n\t\tcheckArea(t, rectangle, 72.0)\n\t})\n\n\tt.Run("circles", func(t *testing.T) {\n\t\tcircle := Circle{10, 0, 0}\n\t\tcheckArea(t, circle, 314.1592653589793)\n\t})\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"go \u4e4b\u4e2d\u63a5\u53e3\u89e3\u6790\u662f\u9690\u5f0f\u7684"}),"\uff0c \u4e0d\u9700\u8981\u663e\u5f0f implements xxx\uff08interface\uff09\uff0c\u53ea\u9700\u8981\u786e\u5b9e\u6709\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5c31\u80fd\u6210\u529f\u7f16\u8bd1"]}),"\n",(0,r.jsxs)(e.p,{children:["Best Practice:\u8868\u7ed3\u6784\u6d4b\u8bd5, \u4f7f\u7528",(0,r.jsx)(e.code,{children:"t.Run"}),"\u548c\u6d4b\u8bd5\u8868\u548c",(0,r.jsx)(e.code,{children:"#%v(\u6253\u5370\u7ed3\u6784)"}),"\u6765\u83b7\u5f97\u6e05\u6670\u7684\u6d4b\u8bd5"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'import (\n\t"math"\n\t"testing"\n)\nfunc TestArea(t *testing.T){\n\tcheckArea := func(t *testing.T, name string, shape Shape, expect float32){\n\t\tt.Run(name, func(t *testing.T){\n\t\t\tdiff := shape.Area() - expect\n\t\t\tif math.Abs(float64(diff)) > 1e-6{\n\t\t\t\tt.Errorf("in %#v, expect %v, got %v, diff %v", shape, expect, shape.Area(), diff)\n\t\t\t}\n\t\t})\n\t}\n\ttestTable:= []struct{\n\t   name string\n       shape Shape\n\t   expect float32\n\t}{\n\t\t{name: "Rectangle",shape: Rectangle{width: 10, height: 10}, expect: 100},\n\t\t{name:"Circle", shape: Circle{radius: 10}, expect: 314.1592653589793},\n\t}\n\n\tfor _, test :=range testTable{\n\t\tcheckArea(t, test.name, test.shape, test.expect)\n\t}\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u6307\u9488\u548c\u9519\u8bef"}),"\n",(0,r.jsx)(e.p,{children:"go \u7684\u51fd\u6570\u9ed8\u8ba4\u90fd\u662f\u503c\u4f20\u9012\uff0c\u800c\u6307\u9488\u53c8\u7531\u4e8e\u8bed\u6cd5\u7cd6\u8868\u73b0\u5f97\u548c\u5f15\u7528\uff08\u7684\u8bed\u6cd5\uff09\u5dee\u4e0d\u591a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:"func (w *Wallet) Withdraw(amount Bitcoin) {\n\tw.balance -= amount\n} // \u8fd9\u662fthis->balance -= amount\nfunc (w Wallet) Withdraw(amount Bitcoin) {\n\tw.balance -= amount\n} // \u8fd9\u662fw = (*this), w.balance -= amount\n"})}),"\n",(0,r.jsx)(e.p,{children:"go \u7528\u8fd4\u56de\u503c\u6765\u8868\u793a\u4e00\u4e2a\u51fd\u6570\u53ef\u80fd\u629b\u51fa\u9519\u8bef\uff08\u5176\u4e2d\u8fd4\u56de\u503c\u7684\u7c7b\u578b\u4e3a error\uff09"}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u679c\u8fd9\u4e2a error \u662f nil\uff08null \u7684\u53d8\u4f53\uff09\uff0c\u90a3\u5c31\u662f\u6b63\u5e38\uff0c\u5426\u5219\u662f\u9519\u8bef\uff0c\u4f8b\u5982"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'func (w *Wallet) Withdraw(amount Bitcoin) error {\n\tif amount > w.balance {\n\t\treturn errors.New("oh no")\n\t}\n\n\tw.balance -= amount\n\treturn nil\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u68c0\u6d4b\u4e00\u4e2a\u7c7b\u662f\u5426\u5b9e\u73b0\u4e86\u63a5\u53e3\u7684\u5168\u90e8\u65b9\u6cd5\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:"var _ Interface = (*Class)(nil) // \u5982\u679cClass\u7c7b\u7684\u6307\u9488\u4e0d\u80fd\u5f3a\u5236\u8f6c\u6362\u6210\u63a5\u53e3\uff0c\u5c31\u6ca1\u6709\u5168\u90e8\u5b9e\u73b0\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u7a7a\u63a5\u53e3\uff1a\u53ef\u4ee5\u8868\u793a\u4efb\u4f55\u7c7b\u578b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'func main(){\n    m := make(map[string]interface{})\n    m["name"]="Tom"\n    m["age"]=18\n    m["parents"]=Persons{A, B}\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:["map ",(0,r.jsx)(e.code,{children:"map[key]value"})]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:"\u4f20\u9012\u6307\u9488\uff08\u6240\u4ee5\u4e0d\u9700\u8981\u4f20\u9012 map \u7684\u5f15\u7528\uff0c\u76f4\u63a5\u4f20\u9012\u5c31\u884c\uff09"}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"var m map[string]string"}),"\u540e\uff0cm \u662f nil\uff0c\u8fd9\u4e0d\u597d\u3002\u8fd9",(0,r.jsx)(e.strong,{children:"\u4e0d\u662f"}),"\u7a7a map"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:"var dictionary = map[string]string{}\n// OR\nvar dictionary = make(map[string]string)\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u6cdb\u578b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:"type List[T any] struct {\n    head, tail *element[T]\n}\ntype element[T any] struct {\n    next *element[T]\n    val  T\n}\nfunc (lst *List[T]) Push(v T) {\n    if lst.tail == nil {\n        lst.head = &element[T]{val: v}\n        lst.tail = lst.head\n    } else {\n        lst.tail.next = &element[T]{val: v}\n        lst.tail = lst.tail.next\n    }\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u5e76\u53d1"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:"goroutine"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n\t"fmt"\n\t"sync"\n\t"time"\n)\n\nfunc ConcurrentDownload(url string) {\n\tvar wg sync.WaitGroup\n\tdownload := func (name string) {\n\t\tfmt.Printf("Start Downloading %v.\\n", name)\n\t\ttime.Sleep(time.Second) // simulate\n\t\tfmt.Printf("%v finished.\\n", name)\n\t\twg.Done()\n\t}\n\tfor i:=0;i<10;i++{\n\t\twg.Add(1)\n\t\tgo download("File"+fmt.Sprint(i))\n\t}\n\twg.Wait()\n}\n\nfunc main(){\n\tConcurrentDownload("http://example.com")\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u5176\u4e2d\uff0c"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"sync.WaitGroup"}),"\u7528\u4e8e\u7b49\u5f85\u6240\u6709\u534f\u7a0b\u7ed3\u675f\uff08\u5176\u5b9e\u662f\u4e00\u4e2a\u8ba1\u6570\u5668\uff0c\u5728\u8ba1\u6570\u4e3a 0 \u7684\u65f6\u5019 Wait()\u5c31\u4e0d\u5835\u585e\u4e86\uff0cAdd()\u52a0\u4e00\uff0cDone()\u51cf\u4e00\uff09"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"go <dosomething>"}),"\u8d77\u4e00\u4e2a dosomething \u7684\u534f\u7a0b"]}),"\n"]}),"\n",(0,r.jsxs)(e.ol,{start:"2",children:["\n",(0,r.jsx)(e.li,{children:"channel"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u5e76\u53d1\u534f\u7a0b\u7684\u901a\u4fe1\u7ba1\u9053"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'package main\nimport (\n\t"fmt"\n)\nfunc PrintFib(n int) {\n\tfib_chan := make(chan int)\n    go func(){\n\t\tx := 0\n\t\ty := 1\n\t\tfor i:=0;i<n;i++{\n\t\t\tfib_chan <- x\n\t\t\tx, y = y, x + y\n\t\t}\n\t\tclose(fib_chan)\n\t}()\n\n\tfor num := range fib_chan{\n\t\tfmt.Printf("%d ", num)\n\t\tfmt.Println()\n\t}\n}\n\nfunc main(){\n\tPrintFib(10)\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u5176\u4e2d\uff0c"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"make \u662f\u4e00\u4e2a\u7c7b\u4f3c malloc \u7684\u4e1c\u897f, \u4f46\u4ed6\u53ef\u4ee5\u81ea\u52a8 gc\uff0c\u5e76\u4e14\u53ef\u4ee5\u5206\u914d channel \u7ba1\u9053"}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"<-"}),"\u662f\u4e00\u4e2a\u8fd0\u7b97\u7b26\uff0c \u5bf9 chan \u4f7f\u7528\uff0c\u4ee3\u8868\u628a\u53f3\u8fb9\u7684\u4e22\u8fdb chan"]}),"\n",(0,r.jsxs)(e.li,{children:["\u7528 make \u521b\u5efa chan\uff0c\u53ef\u4ee5\u6709\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u4ee3\u8868\u7f13\u51b2\u533a\u5927\u5c0f","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5982\u679c\u6ca1\u6709\uff0c\u65e0\u7f13\u51b2\uff0c\u53ea\u6709\u5f53\u63a5\u53d7\u548c\u53d1\u9001\u7aef\u90fd\u5c31\u7eea\u624d\u4f1a\u5f00\u59cb\u53d1\u9001"}),"\n",(0,r.jsx)(e.li,{children:"\u5982\u679c\u6709\uff0csize \u4e3a n\uff0c\u610f\u5473\u7740\u6709\u4e00\u4e2a n \u4e2a\u5143\u7d20\u5927\u5c0f\u7684\u7f13\u51b2\u533a\uff0c\u53d1\u9001\u7aef\u53ef\u4ee5\u63d0\u524d\u53d1\u9001\uff0c\u7f13\u51b2\u533a\u6ee1\u4e4b\u524d\u4e0d\u9700\u8981\u7b49\u5f85\u63a5\u6536\u7aef"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"chan \u652f\u6301 range \u8bed\u6cd5\uff0crange \u4f1a\u6cbf\u7740\u7ba1\u9053\u8fed\u4ee3\u76f4\u81f3\u5173\u95ed\u2014\u2014\u7ba1\u9053\u53ea\u80fd\u88ab\u53d1\u9001\u65b9\u5173\u95ed\uff0c\u63a5\u6536\u65b9\u5173\u95ed\u7ba1\u9053\u540e\u7ee7\u7eed\u53d1\u9001\u4f1a panic"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u7528 channel \u4e5f\u53ef\u4ee5\u8fdb\u884c\u8fd9\u6837\u7684\u540c\u6b65\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'package main\nimport (\n    "fmt"\n    "time"\n)\nfunc worker(done chan bool) {\n    fmt.Print("working...")\n    time.Sleep(time.Second)\n    fmt.Println("done")\n\n    done <- true\n}\nfunc main() {\n    done := make(chan bool, 1)\n    go worker(done)\n    <-done // \u5728\u8fd9\u91cc\u8d77\u5230\u4e86\u7c7b\u4f3cwait()\u6216\u8005join()\u7684\u6548\u679c\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a channel \u53ea\u53ef\u4ee5\u63a5\u53d7/\u53d1\u9001"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:"func pong(pings <-chan string, pongs chan<- string) {\n    // pings\u53ea\u80fd\u53d1\u9001\uff0cpongs\u53ea\u80fd\u63a5\u53d7\n    msg := <-pings\n    pongs <- msg\n}\n"})}),"\n",(0,r.jsxs)(e.ol,{start:"3",children:["\n",(0,r.jsx)(e.li,{children:"select"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u53ef\u4ee5\u540c\u65f6\u7b49\u5f85\u591a\u4e2a channel \u4e0a\u7684\u6d88\u606f"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'package main\nimport (\n    "fmt"\n    "time"\n)\nfunc main() {\n\n    c1 := make(chan string)\n    c2 := make(chan string)\n\n    go func() {\n        time.Sleep(1 * time.Second)\n        c1 <- "one"\n    }()\n    go func() {\n        time.Sleep(2 * time.Second)\n        c2 <- "two"\n    }()\n\n    for i := 0; i < 2; i++ {\n        select {\n        case msg1 := <-c1:\n            fmt.Println("received", msg1)\n        case msg2 := <-c2:\n            fmt.Println("received", msg2)\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"select \u5b9e\u73b0\u8d85\u65f6\u2014\u2014\u4e00\u4e2a\u534f\u7a0b\u5e72\u6d3b\uff0c\u4e00\u4e2a\u534f\u7a0b Sleep timeout \u79d2\uff0c\u7136\u540e select \u4e24\u4e2a\u534f\u7a0b"}),"\n",(0,r.jsx)(e.p,{children:"select \u5b9e\u73b0\u975e\u5835\u585e\u7ba1\u9053\u2014\u2014\u4e00\u4e2a default case\uff0c\u4e0d\u63a5\u6536\u4e1c\u897f"}),"\n",(0,r.jsx)(e.p,{children:"\u534f\u7a0b\u7406\u89e3\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u8f7b\u91cf\u7ea7\u7ebf\u7a0b\uff0c\u8f7b\u91cf\u7ea7\u4f53\u73b0\u5728\u662f\u5728\u7528\u6237\u6001\u7684\u5806\u4e0a\u53bb\u6a21\u62df\u6808\u7ed3\u6784\uff0c\u5728\u4ee3\u7801\u4e4b\u4e2d\u81ea\u5df1\u8c03\u5ea6\uff0c\u800c\u4e0d\u662f\u901a\u8fc7 syscall \u9677\u5165\u5185\u6838\u8c03\u5ea6\u2014\u2014\u5176\u4e2d\u975e\u62a2\u5360\u5f0f\u7684\u5b9e\u73b0\uff08\u4f8b\u5982 python \u7684 asyncio\uff09\uff0c\u901a\u8fc7 yield \u7b49\u5728\u963b\u585e\u65f6\u4e3b\u52a8\u8ba9\u51fa\uff1b\u62a2\u5360\u5f0f\u7684\u5b9e\u73b0\u53ef\u4ee5\u76f4\u63a5\u88ab\u8c03\u5ea6\u5668\u8c03\u5ea6\uff08\u4f8b\u5982 goroutine\uff09"}),"\n",(0,r.jsxs)(e.li,{children:["\u4e5f\u56e0\u4e3a\u662f\u5728\u7528\u6237\u6001\u7684\u8c03\u5ea6\uff0c",(0,r.jsx)(e.strong,{children:"\u534f\u7a0b\u5b9e\u9645\u4e0a\u6ca1\u6709\u5e76\u884c\u7684\u529f\u80fd\uff0c\u53ea\u662f\u63d0\u4f9b\u4e86\u4e00\u4e2a\u975e\u963b\u585e\u7684\u6267\u884c\u6d41"}),"\uff0c\u591a\u4e2a\u534f\u7a0b\u5728\u540c\u4e00\u4e2a\u7ebf\u7a0b\u4e0a\u6267\u884c\uff0c\u4e5f\u53ea\u5360\u636e cpu \u7684\u4e00\u4e2a\u6838\u5fc3"]}),"\n",(0,r.jsx)(e.li,{children:"\u534f\u7a0b\u7684\u7528\u5904\u5728\u4e8e\uff0c\u4ee5\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u65b9\u5f0f\u53bb\u5b8c\u6210\u5835\u585e\u7684\u529f\u80fd\uff08\u4f8b\u5982 IO\uff0c network\uff09\uff0c\u6267\u884c\u4e24\u4e2a IO \u8bf7\u6c42\uff0ccpu \u5de5\u4f5c 1ms\uff0cIO \u5de5\u4f5c 1s\uff0c\u5982\u679c\u662f\u4e24\u4e2a\u7ebf\u7a0b\uff0ccpu \u7684 1ms \u53ef\u4ee5\u5e76\u884c\uff0c\u4f46\u53d7\u9650\u4e8e\u7ebf\u7a0b\u521b\u5efa\u56de\u6536\u8c03\u5ea6\u5f00\u9500\u548c\u7cfb\u7edf\u6700\u5927\u7ebf\u7a0b\u8d44\u6e90\u9650\u5236\uff0c\u5b9e\u9645\u635f\u8017\u7684\u65f6\u95f4\u5f88\u53ef\u80fd\u5927\u4e8e ms \u7ea7\u522b\u3002\u800c\u534f\u7a0b\u5728 cpu \u4e0a\u9700\u8981\u4f9d\u6b21\u8fd0\u884c\u4e24\u4e2a 1ms,\u4f46\u662f\u540c\u6837\u4e0d\u9700\u8981\u88ab IO \u5835\u585e"}),"\n",(0,r.jsx)(e.li,{children:"\u5177\u4f53\u7684\u5b9e\u73b0\u65b9\u5f0f\u800c\u8a00\uff0c\u5206\u4e3a\u6709\u6808\u534f\u7a0b\u548c\u65e0\u6808\u534f\u7a0b\uff0c\u6709\u6808\u534f\u7a0b\u6709\u81ea\u5df1\u7684\u4e00\u6bb5\u6a21\u62df\u7684\u6808\u7a7a\u95f4\uff0c\u5728\u5207\u6362\u65f6\u4fdd\u5b58\u5bc4\u5b58\u5668\u5230\u6808\u91cc\u9762\uff1b\u65e0\u6808\u534f\u7a0b\u4f7f\u7528\u72b6\u6001\u673a\u5b9e\u73b0\uff0c\u5728\u5207\u6362\u65f6\u8bb0\u5f55\u72b6\u6001\u673a\u7684\u72b6\u6001\u3002\u6709\u6808\u534f\u7a0b\u5f00\u9500\u66f4\u5927\uff0c\u4f46\u8868\u8fbe\u529b\u66f4\u5f3a"}),"\n",(0,r.jsx)(e.li,{children:"ts \u91cc\u9762\u7684 async/await \u5c31\u662f\u534f\u7a0b\u7684\u5305\u88c5\uff0cawait \u5c31\u662f\u8bb0\u5f55\u72b6\u6001\u7684\u70b9\uff0c\u7a0b\u5e8f\u5411\u4e0b\u6267\u884c\u5230 await \u5904\u6682\u505c\u534f\u7a0b\uff0c\u7b49\u5f85 await \u4e8b\u4ef6\u5b8c\u6210"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"timer&ticker \u5185\u7f6e\u8ba1\u65f6\u5668, \u53ef\u7528\u4e8e\u9650\u6d41\u7b49"}),"\n",(0,r.jsx)(e.p,{children:"defer \u5ef6\u8fdf\u505a\u67d0\u4ef6\u4e8b\uff0c\u5e38\u89c1\u4e8e\u6a21\u62df\u4e00\u79cd RAII\uff0c\u65e0\u8bba\u662f\u4f55\u79cd\u65b9\u5f0f\u9000\u51fa\u90fd\u80fd\u6b63\u5e38\u6267\u884c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:"func writeToFile(filename string, data []byte) error {\n    file, err := os.Create(filename)\n    if err != nil {\n        return err\n    }\n    defer file.Close() // \u786e\u4fdd\u6587\u4ef6\u5728\u51fd\u6570\u7ed3\u675f\u65f6\u88ab\u5173\u95ed,defer\u540e\u7684\u8c03\u7528\u4f1a\u5728defer\u6240\u5728\u7684\u51fd\u6570\u7ed3\u675f\u540e\u6267\u884c\n\n    _, err = file.Write(data)\n    return err\n}\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:" \tvar wg sync.WaitGroup\n    for i := 1; i <= 5; i++ {\n        wg.Add(1)\n        go func() {\n            defer wg.Done()\n            worker(i)\n        }()\n    }\n"})}),"\n",(0,r.jsxs)(e.ol,{start:"5",children:["\n",(0,r.jsx)(e.li,{children:"\u539f\u5b50\u64cd\u4f5c"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'package main\nimport (\n    "fmt"\n    "sync"\n    "sync/atomic"\n)\nfunc main() {\n    var ops atomic.Uint64\n    var wg sync.WaitGroup\n    for i := 0; i < 50; i++ {\n        wg.Add(1)\n        go func() {\n            for c := 0; c < 1000; c++ {\n                ops.Add(1)\n            }\n            wg.Done()\n        }()\n    }\n    wg.Wait()\n\n    fmt.Println("ops:", ops.Load()) //50000\n}\n'})}),"\n",(0,r.jsxs)(e.ol,{start:"6",children:["\n",(0,r.jsx)(e.li,{children:"mutex \u9501"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:"type Container struct {\n    mu       sync.Mutex\n    counters int\n}\nfunc (c *Container) inc(name string) {\n    c.mu.Lock()\n    defer c.mu.Unlock()\n    c.counters++\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"Useful API"}),"\n",(0,r.jsxs)(e.p,{children:["Sort \u6392\u5e8f(",(0,r.jsx)(e.code,{children:"slices"}),") \u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u8c13\u8bcd"]}),"\n",(0,r.jsxs)(e.p,{children:["\u81ea\u5b9a\u4e49\u6392\u5e8f\u4e4b\u4e2d\u7684\u5185\u7f6e\u7c7b\u578b\u7684\u6bd4\u8f83\u7528",(0,r.jsx)(e.code,{children:"cmp.Compare()"})]}),"\n",(0,r.jsx)(e.p,{children:"\u4f8b\u5982"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:"PersonCmp := func(a *Person, b *Person){\n    return cmp.Compare(a.name, b.name)\n}\nslices.SortFunc(Persons, PersonCmp)\nslices.Sort(ints)\nslices.isSorted(ints)\n"})}),"\n",(0,r.jsxs)(e.p,{children:["go \u6709\u5185\u7f6e",(0,r.jsx)(e.code,{children:"panic(msg string)"}),"\u548c",(0,r.jsx)(e.code,{children:"recover"}),"(\u5728 defer \u5185\u90e8\uff0ccatch panic)"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'// recover \u7684\u8fd4\u56de\u503c\u662f\u8c03\u7528 panic \u65f6\u5f15\u53d1\u7684\u9519\u8bef\u3002\n    defer func() {\n        if r := recover(); r != nil {\n            fmt.Println("Recovered. Error:\\n", r)\n        }\n    }()\n\tmayPanic()\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u5b57\u7b26\u4e32\u76f8\u5173\u51fd\u6570"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'package main\nimport (\n    "fmt"\n    s "strings"\n)\nvar p = fmt.Println\nfunc main() {\n    p("Contains:  ", s.Contains("test", "es"))\n    p("Count:     ", s.Count("test", "t"))\n    p("HasPrefix: ", s.HasPrefix("test", "te"))\n    p("HasSuffix: ", s.HasSuffix("test", "st"))\n    p("Index:     ", s.Index("test", "e"))\n    p("Join:      ", s.Join([]string{"a", "b"}, "-"))\n    p("Repeat:    ", s.Repeat("a", 5))\n    p("Replace:   ", s.Replace("foo", "o", "0", -1))\n    p("Replace:   ", s.Replace("foo", "o", "0", 1))\n    p("Split:     ", s.Split("a-b-c-d-e", "-"))\n    p("ToLower:   ", s.ToLower("TEST"))\n    p("ToUpper:   ", s.ToUpper("test"))\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u6b63\u5219\uff1a",(0,r.jsx)(e.code,{children:"regexp"}),"\u5305"]}),"\n",(0,r.jsx)(e.p,{children:"JSON \u5305\uff0crand \u5305"}),"\n",(0,r.jsx)(e.p,{children:"parse \u6570\u5b57\uff0c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n    "fmt"\n    "strconv"\n)\n\nfunc main() {\n    f, _ := strconv.ParseFloat("1.234", 64)\n    i, _ := strconv.ParseInt("123", 0, 64) // 0:\u4ece\u5b57\u7b26\u4e32\u63a8\u65ad\u57fa\u6570\uff0c 64:int64\n    d, _ := strconv.ParseInt("0x1c8", 0, 64)\n    u, _ := strconv.ParseUint("789", 0, 64)\n    k, _ := strconv.Atoi("135")\n    _, e := strconv.Atoi("wat")\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u6587\u4ef6 IO\uff0c\u5b8c\u5168\u7c7b\u4f3c c"}),"\n",(0,r.jsxs)(e.p,{children:["ReadFile \u8bfb\u53d6\u6574\u4e2a\u6587\u4ef6\uff0cRead \u8bfb\u53d6\u51e0\u4e2a\u5b57\u8282\uff08\u7528",(0,r.jsx)(e.code,{children:"make([]byte, size)"}),"\u88c5),Seek \u6709\u4e09\u79cd\u65b9\u5f0f io.SeekStart, io.SeekCurrent, io.SeekEnd,bufio \u63d0\u4f9b\u5e26\u7f13\u51b2 IO"]}),"\n",(0,r.jsx)(e.p,{children:"Write, WriteFile, Create, Flush, Sync, WriteString(in bufio)\u540c\u7406"}),"\n",(0,r.jsx)(e.p,{children:"\u5220\u9664\u6587\u4ef6 os.Remove"}),"\n",(0,r.jsxs)(e.p,{children:["\u6587\u4ef6\u8def\u5f84",(0,r.jsx)(e.code,{children:"path/filepath"}),"\u5305\uff0cfilepath.Join \u8fde\u63a5\u8def\u5f84 Ext \u5f97\u5230\u62d3\u5c55\u540d\uff0c Dir \u5f97\u5230\u6587\u4ef6\u76ee\u5f55\uff0cBase \u5f97\u5230\u6587\u4ef6\u540d"]}),"\n",(0,r.jsxs)(e.p,{children:["\u6587\u4ef6\u5939 os.Mkdir, os.RemoveAll \uff08\u7b49\u6548\u4e8e",(0,r.jsx)(e.code,{children:"rm -rf"}),"\uff09, os.Chdir, os.ReadDir(\u5f97\u5230\u6587\u4ef6\u7684\u96c6\u5408)"]}),"\n",(0,r.jsx)(e.p,{children:"WalkDir \u9012\u5f52\u904d\u5386"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'err = filepath.WalkDir("subdir", visit)\nfunc visit(path string, d fs.DirEntry, err error) error {\n    if err != nil {\n        return err\n    }\n    fmt.Println(" ", path, d.IsDir())\n    return nil\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:["//go",":embed"," \u5728\u7f16\u8bd1\u51fa\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e4b\u4e2d\u5305\u542b"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:"//go:embed folder/single_file.txt\nvar fileString string  // \u5c06folder/single_file.txt\u7684\u5185\u5bb9\u653e\u5230fileString\u91cc\u9762\uff0c\u5e76\u5728\u7f16\u8bd1\u65f6\u5e26\u4e0a\u8be5txt\n"})}),"\n",(0,r.jsx)(e.p,{children:"os.Args \u547d\u4ee4\u884c\u53c2\u6570"}),"\n",(0,r.jsx)(e.p,{children:"os.Getenv / Setenv \u73af\u5883\u53d8\u91cf"}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h4,{id:"gin",children:"Gin"}),"\n",(0,r.jsx)(e.p,{children:"start"}),"\n",(0,r.jsx)(e.p,{children:"r \u6307\u5b9a\u4e00\u4e2a wsgi \u5e94\u7528\u5b9e\u4f8b"}),"\n",(0,r.jsx)(e.p,{children:"GET \u8def\u7531\u54cd\u5e94"}),"\n",(0,r.jsxs)(e.p,{children:["Run() \u53ef\u4ee5\u5e26\u4e00\u4e2a\u53c2\u6570\uff0c\u4f8b\u5982",(0,r.jsx)(e.code,{children:'Run(":9090")'}),"\u8fd9\u91cc\u4f7f\u7528\u9ed8\u8ba4 8080"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n\t"github.com/gin-gonic/gin"\n)\n\nfunc main(){\n\tr := gin.Default()\n\tr.GET("/ping", func(c *gin.Context) {\n\t\tc.JSON(200, gin.H{\n\t\t\t"message": "pong",\n\t\t})\n\t})\n\tr.Run() // \u76d1\u542c\u5e76\u5728 0.0.0.0:8080 \u4e0a\u542f\u52a8\u670d\u52a1\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u8def\u7531\uff0cGET\uff0cPOST\uff0cPUT\uff0cDELETE\uff0c..."}),"\n",(0,r.jsx)(e.p,{children:"\u52a8\u6001\u8def\u7531\uff0c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'r.GET("/user/:name", func(c *gin.Context) {\n\tname := c.Param("name")\n\tc.String(http.StatusOK, "Hello %s", name)\n}) // \u5339\u914d/user/ayanami\n\n\n'})}),"\n",(0,r.jsx)(e.p,{children:"Query"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'// \u5339\u914dusers?name=xxx&role=xxx\uff0crole\u53ef\u9009\nr.GET("/users", func(c *gin.Context) {\n\tname := c.Query("name")\n\trole := c.DefaultQuery("role", "admin")\n\tc.String(http.StatusOK, "%s is a %s", name, role)\n})\n'})}),"\n",(0,r.jsx)(e.p,{children:"POST"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'r.POST("/form", func(c *gin.Context) {\n\tusername := c.PostForm("username")\n\tpassword := c.DefaultPostForm("password", "000000") // \u53ef\u8bbe\u7f6e\u9ed8\u8ba4\u503c\n\n\tc.JSON(http.StatusOK, gin.H{\n\t\t"username": username,\n\t\t"password": password,\n\t})\n})\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u70ed\u66f4\u65b0\uff1a\u4f7f\u7528 air (",(0,r.jsx)(e.a,{href:"https://github.com/air-verse/air/blob/master/README-zh_cn.md",children:"https://github.com/air-verse/air/blob/master/README-zh_cn.md"}),")"]}),"\n",(0,r.jsx)(e.p,{children:"\u91cd\u5b9a\u5411"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'r.GET("/redirect", func(c *gin.Context) {\n    c.Redirect(http.StatusMovedPermanently, "/index")\n})\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u4e0a\u4f20\u6587\u4ef6"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'r.POST("/upload1", func(c *gin.Context) {\n\tfile, _ := c.FormFile("file")\n\t// c.SaveUploadedFile(file, dst)\n\tc.String(http.StatusOK, "%s uploaded!", file.Filename)\n})\n'})}),"\n",(0,r.jsx)(e.p,{children:"ShouldBindJson, ShouldBindQuery, ShouldBindUri \u5c06\u4f20\u5165\u7684 json, xml, uri \u7b49\u5c1d\u8bd5\u89e3\u6790\u5230\u67d0\u4e2a\u7ed3\u6784\u4f53, \u89e3\u6790\u5931\u8d25\u8fd4\u56de err"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'\tvar request dto.CourseDetailRequest\n\tif err := c.ShouldBindUri(&request); err != nil {\n\t\tc.JSON(http.StatusNotFound, dto.BaseResponse{Message: "\u53c2\u6570\u9519\u8bef"})\n\t\treturn\n\t}\n\tcourse, err := service.GetCourseDetail(c, request.CourseID) // \u6210\u529f\u89e3\u6790\u5c31\u53ef\u4ee5\u7528\u6210\u5458\u53d8\u91cf\u4e86\n\ntype CourseDetailRequest struct {\n\tCourseID int64 `uri:"courseID" binding:"required"`\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:'\u6307\u5b9a binding:"required"\u4f1a\u62d2\u7edd\u7a7a\u53c2\u6570\uff0c\u81ea\u52a8\u6821\u9a8c'}),"\n",(0,r.jsx)(e.p,{children:"\u8fd8\u53ef\u4ee5\u5728 binding \u91cc\u9762\u6307\u5b9a\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u5668\uff0c\u5177\u4f53\u770b\u5b98\u65b9\u6587\u6863\uff0c\u53c2\u6570\u6bd4\u8f83\u591a\uff0c\u5b8c\u6210\u8868\u5355\u9a8c\u8bc1\u529f\u80fd\uff0c\u901a\u8fc7\u53cd\u5c04"}),"\n",(0,r.jsx)(e.p,{children:"\u6587\u4ef6\u4e0a\u4f20\u548c\u8fd4\u56de\uff1a FormFile \u548c SaveUploadFile, \u8fd8\u6709 MaxMultipartMemory"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'func main() {\n\trouter := gin.Default()\n\t// \u4e3a multipart forms \u8bbe\u7f6e\u8f83\u4f4e\u7684\u5185\u5b58\u9650\u5236 (\u9ed8\u8ba4\u662f 32 MiB)\n\trouter.MaxMultipartMemory = 8 << 20  // 8 MiB\n\trouter.POST("/upload", func(c *gin.Context) {\n\t\t// \u5355\u6587\u4ef6, \u8fd9\u91cc\u7684file\u5b9e\u9645\u4e0a\u662fFileHeader\u7684\u7c7b\u578b\uff0c\u53ef\u4ee5\u6709file.Filename .Size\u5f97\u5230\u4e00\u4e9b\u57fa\u7840\u4fe1\u606f\n\t\tfile, _ := c.FormFile("file")\n\t\tlog.Println(file.Filename)\n\n\t\tdst := "./" + file.Filename\n\t\t// \u4e0a\u4f20\u6587\u4ef6\u81f3\u6307\u5b9a\u7684\u5b8c\u6574\u6587\u4ef6\u8def\u5f84\n\t\tc.SaveUploadedFile(file, dst)\n\n\t\tc.String(http.StatusOK, fmt.Sprintf("\'%s\' uploaded!", file.Filename))\n\t})\n\trouter.Run(":8080")\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u4e2d\u95f4\u4ef6\u548c\u5206\u7ec4\u8def\u7531"}),"\n",(0,r.jsx)(e.p,{children:"\u5206\u7ec4\uff1a\u7ba1\u7406\u8def\u7531"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'v1 := r.Group("/v1").Use(publicHandler)\n{\n\tv1.GET("/posts", defaultHandler1)\n\tv1.GET("/series", defaultHandler2)\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u4e2d\u95f4\u4ef6\uff1a\u5728\u8bf7\u6c42\u5230\u8fbe\u8def\u7531\u7684\u524d\u540e\u8fdb\u884c\u7684\u4e00\u7cfb\u5217\u64cd\u4f5c\uff08\u4f8b\u5982 jwt \u9274\u6743\uff09"})," ",(0,r.jsx)(e.code,{children:"Use()"}),"api"]}),"\n",(0,r.jsxs)(e.p,{children:["\u5c31\u662f\u4e00\u4e2a\u8fd4\u56de ",(0,r.jsx)(e.code,{children:"c *gin.Context"}),"\u7684 func"]}),"\n",(0,r.jsx)(e.p,{children:"Context\uff1a\u67d0\u79cd\u952e\u503c\u5bf9"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'func Logger() gin.HandlerFunc {\n\treturn func(c *gin.Context) {\n\t\tt := time.Now()\n\n\t\t// \u8bbe\u7f6e example \u53d8\u91cf\n\t\tc.Set("example", "12345")\n\n        // \u8bf7\u6c42\u524d\uff0cNext()\u524d\n\n\t\tc.Next() // \u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a\u4e2d\u95f4\u4ef6\n\n        // \u8bf7\u6c42\u540e\uff0c\u56de\u6765\u7684\u65f6\u5019\n\t\tlatency := time.Since(t)\n\t\tlog.Print(latency)\n\n\t\t// \u83b7\u53d6\u53d1\u9001\u7684 status\n\t\tstatus := c.Writer.Status()\n\t\tlog.Println(status)\n\t}\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u5b9e\u9645\u4e0a\u662f\u6d0b\u8471\u6a21\u5f0f"}),"\n",(0,r.jsx)(e.p,{children:"\u4e2d\u95f4\u4ef6\u5d4c\u5957 m1 before -> m2 before -> core -> m2 after -> m1 after"}),"\n",(0,r.jsx)(e.p,{children:"\u8fd8\u6709\u4e00\u4e2a api \u662f c.Abort() \u4f8b\u5982\u7528\u6237\u9a8c\u8bc1\u5931\u8d25\u65f6\uff0c\u8c03\u7528\u5b83\u963b\u6b62\u7ee7\u7eed\u5411\u4e0b\u4e00\u5c42\u4e2d\u95f4\u4ef6\u4f20\u9012"}),"\n",(0,r.jsx)(e.p,{children:"\u4e0a\u4e00\u5c42 Set \u4e86\u4e4b\u540e\uff0c\u4e0b\u4e00\u5c42\u5c31\u53ef\u4ee5\u4ece Context \u91cc\u9762 Get"}),"\n",(0,r.jsx)(e.p,{children:"\u65e5\u5fd7\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'func main() {\n    // \u7981\u7528\u63a7\u5236\u53f0\u989c\u8272\uff0c\u5c06\u65e5\u5fd7\u5199\u5165\u6587\u4ef6\u65f6\u4e0d\u9700\u8981\u63a7\u5236\u53f0\u989c\u8272\u3002\n    gin.DisableConsoleColor()\n\n    // \u8bb0\u5f55\u5230\u6587\u4ef6\u3002\n    f, _ := os.Create("gin.log")\n    gin.DefaultWriter = io.MultiWriter(f)\n\n    // \u5982\u679c\u9700\u8981\u540c\u65f6\u5c06\u65e5\u5fd7\u5199\u5165\u6587\u4ef6\u548c\u63a7\u5236\u53f0\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u7801\u3002\n    // gin.DefaultWriter = io.MultiWriter(f, os.Stdout)\n\n    router := gin.Default()\n    router.GET("/ping", func(c *gin.Context) {\n        c.String(200, "pong")\n    })\n\n    router.Run(":8080")\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u81ea\u5b9a\u4e49\u65e5\u5fd7\uff1a\u770b\u6587\u6863"}),"\n",(0,r.jsx)(e.p,{children:"\u7075\u6d3b\u5ea6\u4e0d\u591f\u3001\u65e5\u5fd7\u62c6\u5206 go-logging, logrus(recommended)"}),"\n",(0,r.jsx)(e.p,{children:"\u6210\u54c1\u65e5\u5fd7\u5305"}),"\n",(0,r.jsx)(e.h3,{id:"gorm",children:"gorm"}),"\n",(0,r.jsx)(e.p,{children:"\u8fd9\u4e2a\u66f4\u662f\u4f9d\u6258\uff0c\u5168\u770b\u6587\u6863\u5c31\u884c\uff0c\u91cc\u9762\u4e00\u5806\u6307\u9488\u4e71\u98de\u548c\u795e\u5947\u8bed\u4e49\u548c\u7c7b\u4f3c Any \u7684\u5b57\u7b26\u4e32\u53cd\u5c04\u90fd\u662f\u4f9d\u6258"}),"\n",(0,r.jsx)(e.p,{children:"\u5efa\u8bae\u59cb\u7ec8\u5f00\u6587\u6863\u5f00\u53d1"}),"\n",(0,r.jsx)(e.p,{children:"Open \u94fe\u63a5\uff0cAutoMigrate \u5efa\u8868"}),"\n",(0,r.jsx)(e.p,{children:"\u589e\u5220\u6539 Create Delete Update\u3001Updates\uff08Update key value, Updates map/struct\uff09 (Save)"}),"\n",(0,r.jsx)(e.p,{children:"\u67e5 First Find \u6839\u636e\u6709\u65e0 ID\uff08\u4e3b\u952e\uff09\u51b3\u5b9a\u67e5\u5168\u8868\u8fd8\u662f\u67e5\u4e00\u4e2a\u5177\u4f53\u7684\uff0c\u5982\u679c\u67e5\u5168\u8868\u4f20\u4e00\u4e2a\u7a7a\u5bf9\u8c61\u7684\u6307\u9488\u5c31\u884c\uff0cFirst \u5355\u4e2a\uff0cFind \u67e5\u5207\u7247"}),"\n",(0,r.jsx)(e.p,{children:"\u6761\u4ef6 Where Or \u586b\u7b80\u5355 sql"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'// Get first matched record\ndb.Where("name = ?", "jinzhu").First(&user)\n// SELECT * FROM users WHERE name = \'jinzhu\' ORDER BY id LIMIT 1;\n\n// Get all matched records\ndb.Where("name <> ?", "jinzhu").Find(&users)\n// SELECT * FROM users WHERE name <> \'jinzhu\';\n\n// IN\ndb.Where("name IN ?", []string{"jinzhu", "jinzhu 2"}).Find(&users)\n// SELECT * FROM users WHERE name IN (\'jinzhu\',\'jinzhu 2\');\n\n// LIKE\ndb.Where("name LIKE ?", "%jin%").Find(&users)\n// SELECT * FROM users WHERE name LIKE \'%jin%\';\n\n// AND\ndb.Where("name = ? AND age >= ?", "jinzhu", "22").Find(&users)\n// SELECT * FROM users WHERE name = \'jinzhu\' AND age >= 22;\n\n// Time\ndb.Where("updated_at > ?", lastWeek).Find(&users)\n// SELECT * FROM users WHERE updated_at > \'2000-01-01 00:00:00\';\n\n// BETWEEN\ndb.Where("created_at BETWEEN ? AND ?", lastWeek, today).Find(&users)\n// SELECT * FROM users WHERE created_at BETWEEN \'2000-01-01 00:00:00\' AND \'2000-01-08 00:00:00\';\n\n'})}),"\n",(0,r.jsx)(e.p,{children:"Delete \u9ed8\u8ba4\u8f6f\u5220\u9664\uff08\u5982\u679c\u6a21\u578b\u6709 DeleteAt \u5b57\u6bb5\uff0c\u4f8b\u5982\u4f7f\u7528 gorm.Modal\uff09"}),"\n",(0,r.jsx)(e.p,{children:"\u7528 Unscoped().Delete()\u786c\u5220\u9664"}),"\n",(0,r.jsx)(e.p,{children:"\u7ed3\u6784\u4f53 tag + \u4e00\u5bf9\u4e00\u3001\u4e00\u5bf9\u591a\u3001\u591a\u5bf9\u591a\uff1a\u770b\u6587\u6863"}),"\n",(0,r.jsx)(e.p,{children:"\u6709 django \u4e00\u8109\u76f8\u627f\u7684\u624b\u52a8 Preload()"}),"\n",(0,r.jsx)(e.p,{children:"JWT: jwt-go \u6587\u6863"}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h3,{id:"\u5b9e\u6218jcourse_go",children:"\u5b9e\u6218\uff1ajcourse_go"}),"\n",(0,r.jsx)(e.p,{children:"main.go"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Init() godotenv \u4ece",(0,r.jsx)(e.code,{children:".env"}),"\u6587\u4ef6\u4e4b\u4e2d\u8bfb\u73af\u5883\u53d8\u91cf"]}),"\n",(0,r.jsx)(e.li,{children:"\u94fe\u63a5 Redis, DB, OpenAI api"}),"\n",(0,r.jsx)(e.li,{children:"registerRouter, \u542f\u52a8 gin Engine"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"router.go"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"InitSession() \u4ece\u73af\u5883\u53d8\u91cf SESSION_SECRET \u83b7\u53d6\u5bc6\u94a5\u540e tcp \u94fe\u63a5 Redis\uff0c\u96c6\u6210\u8fdb\u5165 gin (Sessions API \u6307\u5b9a\u5b58\u7684\u5730\u65b9 NewRedisStore \u5c31\u884c)"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u8def\u7531\u7ec4\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"authGroup \u767b\u9646\u76f8\u5173\uff0c\u4e0d\u9700\u8981 auth"}),"\n",(0,r.jsx)(e.li,{children:"needAuthGroup \u5176\u4ed6\u975e Admin(teacher, course, review, user) \u8fc7\u4e2d\u95f4\u4ef6 RequireAuth() \u5224\u65ad Session()\u91cc\u9762\u6709\u6ca1\u6709 Use"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'func RequireAuth() gin.HandlerFunc {\n\treturn func(c *gin.Context) {\n\t\tsession := sessions.Default(c)\n\t\tuser := session.Get(constant.SessionUserAuthKey)\n\t\tif user == nil {\n\t\t\tc.JSON(http.StatusUnauthorized, dto.BaseResponse{Message: "\u672a\u6388\u6743\u7684\u8bf7\u6c42"})\n\t\t\tc.Abort()\n\t\t}\n\t\tc.Next()\n\t}\n}\n\n'})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"adminGroup \u8fc7\u4e2d\u95f4\u4ef6 RequireAdmin() \u5c31\u662f\u518d\u52a0\u4e86\u4e00\u4e2a\u5224\u65ad User \u7684 Role"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"handlers(\u67d0\u79cd\u610f\u4e49\u4e0a\u7684 Controllers in java)"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"auth: \u5f88\u91cd\u590d\u7684\u4e1c\u897f"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"course:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Get","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u4ece\u8bbe\u7f6e\u91cc\u9762\u62ff\u5230 page \u548c pageSize \u53c2\u6570\u6784\u9020 request"}),"\n",(0,r.jsx)(e.li,{children:"\u5c06 Query \u7ed1\u5b9a\u5230 request(\u8bfb\u53d6\u53c2\u6570)"}),"\n",(0,r.jsx)(e.li,{children:"\u505a\u4e00\u4e2a\u4ece request \u7684,,,\u7684 json \u5f62\u5f0f\u8f6c\u6362\u4e3a\u6570\u7ec4\u518d\u6784\u9020 filter \u7ed3\u6784"}),"\n",(0,r.jsx)(e.li,{children:"\u4f20\u7ed9 service \u7684 api"}),"\n",(0,r.jsx)(e.li,{children:"\u8fd4\u56de\u7ed3\u679c\u8fc7 DTO\uff0cTotal, Data, Page, PageSize \u7edf\u4e00 BasePaginateResponse \u7ed3\u6784"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"\u63a8\u8350"}),"\n",(0,r.jsx)(e.li,{children:"\u5173\u6ce8\u548c\u53d6\u6d88\u5173\u6ce8"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"ReviewReaction \u70b9\u8d5e\u3001\u8e29"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"ReviewReply \u56de\u590d"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"Review"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"CRUD + \u63a8\u8350\uff0c \u540c course"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"Teacher"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"User"}),"\n"]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(o,{...n})}):o(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>c,x:()=>l});var r=t(6540);const s={},i=r.createContext(s);function c(n){const e=r.useContext(i);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:c(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);